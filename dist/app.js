"use strict";function config(e,t){e.html5Mode(!0),t.registerUrl("https://amber-heat-8766.firebaseio.com")}function AppController(e,t,n,o){var i=this;e.auth=n,e.activeRoute="MyFeed",i.openAddSpice=function(){o.setObj(null),e.activeRoute="AddSpice",t.navigate(["AddSpice"])}}function AddSpiceController(e,t,n){function o(){if(i.spice&&i.spice.tags){var e=i.spice.tags.split(",");return e=e.map(function(e){return{text:e}})}return null}var i=this,r=t.getTagList();i.spice=t.getObj(),i.tags=o(),i.isUpdate=i.spice,i.add=function(){angular.isArray(i.tags)&&(i.spice.tags=i.tags.map(function(e){return e.text}).join(",")),i.isUpdate?t.update(i.spice):t.add(i.spice),i.spice={},i.tags=null,i.spiceForm.$setPristine(),i.showStatus=!0},i.$routerCanReuse=function(){return!1},i.getTagList=function(e){return angular.isArray(r)?r.filter(function(t){return 0===t.text.toLowerCase().indexOf(e.toLowerCase())}):null},i.ok=function(){i.showStatus=!1,i.isUpdate=!1}}function LoginButtonController(e){var t=this;t.isLoggedIn=function(){return e.isLoggedIn()},t.login=function(){e.login().then(function(e){t.authData=e,console.log(t.authData)})},t.logout=function(){e.logout()}}function MyFeedController(e,t,n,o){var i=this,r=null;i.filter=function(e){var t=!0;if(r&&(t=e.user&&e.user.uid===r||e.pinnedUsers&&e.pinnedUsers[r]===!0),n.search){var o=n.search.toLowerCase();t=e.name.toLowerCase().indexOf(o)>=0||e.user.name.toLowerCase().indexOf(o)>=0,!t&&e.description&&(t=e.description.toLowerCase().indexOf(o)>=0),!t&&e.ingredients&&(t=e.ingredients.toLowerCase().indexOf(o)>=0),!t&&e.directions&&(t=e.directions.toLowerCase().indexOf(o)>=0),!t&&e.tags&&(t=e.tags.toLowerCase().indexOf(o)>=0)}return t},i.$routerOnActivate=function(t){if(console.log("route state: "+t.params.state),t.params.state&&o.isLoggedIn()){var a=o.getUser();r=a.uid,n.activeRoute="MySpice"}else r=null,n.activeRoute="MyFeed";i.spices=e.getAll()}}function SpiceCardController(e,t,n,o){var i=this;o.getUser();i.togglePin=function(t){e.togglePin(t)},i.edit=function(o){e.setObj(o),n.activeRoute="AddSpice",t.navigate(["AddSpice"])},i["delete"]=function(t){e.remove(t)}}function authService(e,t,n){function o(){return null!==l}function i(){return null!==l?{uid:l.uid,name:l.google.displayName,profileImageURL:l.google.profileImageURL,provider:l.provider}:null}function r(){return u.$authWithOAuthPopup("google",{}).then(function(e){return l=e},function(e){n.reject(e)})}function a(){ref.unauth(),l=null}var l=null,u=e(t["default"]),c={isLoggedIn:o,getUser:i,login:r,logout:a};return c}function spiceApi(e,t,n){function o(){return g}function i(){return d}function r(e){d=e}function a(e){var t=f.getAll();return e.timestamp=Firebase.ServerValue.TIMESTAMP,e.user=n.getUser(),console.log(e),t.$add(e)}function l(e){var t=f.getAll();e.timestamp=Firebase.ServerValue.TIMESTAMP,console.log(e),t.$save(e)}function u(e){var t=f.getAll();console.log(e),t.$remove(e)}function c(e){var t=n.getUser();e.user.uid!==t.uid&&(e.pinnedUsers||(e.pinnedUsers={}),e.pinnedUsers[t.uid]=!(e.pinnedUsers[t.uid]===!0),f.update(e))}function p(){return s||(s=[{text:"appetizer"},{text:"dessert"}]),s}var s,d=null,g=(new Date,e(t["default"])),f={getAll:o,getObj:i,setObj:r,add:a,update:l,remove:u,togglePin:c,getTagList:p};return f}angular.module("allSpiceApp",["ngComponentRouter","firebase","ngTagsInput"]).config(config).value("$routerRootComponent","app"),config.$inject=["$locationProvider","$firebaseRefProvider"],angular.module("allSpiceApp").component("app",{templateUrl:"app/app.html",controller:AppController,$routeConfig:[{path:"/myFeed",name:"MyFeed",component:"myFeed",useAsDefault:!0},{path:"/addSpice",name:"AddSpice",component:"addSpice"}]}),AppController.$inject=["$rootScope","$rootRouter","authService","spiceApi"],angular.module("allSpiceApp").component("addSpice",{controller:AddSpiceController,templateUrl:"app/addspice/addspice.html"}),AddSpiceController.$inject=["$firebaseArray","spiceApi","$timeout"],angular.module("allSpiceApp").component("saLoginButton",{controller:LoginButtonController,templateUrl:"app/components/loginbutton.html"}),LoginButtonController.$inject=["authService"],angular.module("allSpiceApp").component("myFeed",{controller:MyFeedController,templateUrl:"app/myfeed/myfeed.html"}),MyFeedController.$inject=["spiceApi","$rootRouter","$rootScope","authService"],angular.module("allSpiceApp").component("saSpiceCard",{bindings:{spice:"<"},controller:SpiceCardController,templateUrl:"app/myfeed/spice.html"}),SpiceCardController.$inject=["spiceApi","$rootRouter","$rootScope","authService"],angular.module("allSpiceApp").factory("authService",authService),authService.$inject=["$firebaseAuth","$firebaseRef","$q"],angular.module("allSpiceApp").factory("spiceApi",spiceApi),spiceApi.$inject=["$firebaseArray","$firebaseRef","authService"];